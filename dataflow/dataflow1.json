{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "tblVisits",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "tblPatients",
						"type": "DatasetReference"
					},
					"name": "source2"
				},
				{
					"dataset": {
						"referenceName": "tblTests",
						"type": "DatasetReference"
					},
					"name": "source3"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "join1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Id as integer,",
				"          PatientID as string,",
				"          VisitDate as timestamp,",
				"          Weight as float,",
				"          Notes as string,",
				"          NowPregnant as string,",
				"          FamilyPlanningID as string,",
				"          TBScreeningID as string,",
				"          TBRXIPTID as string,",
				"          ARVStatusCode as integer,",
				"          ARVReasonCode as integer,",
				"          ARVCode as integer,",
				"          NutritionalStatusID as string,",
				"          NutritionalSupplementID as string,",
				"          Complications as string,",
				"          RelevantCoMedication as string,",
				"          StaffID as integer,",
				"          TheHeight as double,",
				"          WHOStage as integer,",
				"          FunctionalStatusCode as string,",
				"          ARVAdherenceCode as string,",
				"          EligibilityReasonCode as string,",
				"          NumDaysDispensed as integer,",
				"          VisitTypeCode as string,",
				"          LocationFacilityCode as string,",
				"          UserNumber as integer,",
				"          TheTimeStamp as timestamp,",
				"          RowVersion as timestamp,",
				"          HepatitisScreening as string,",
				"          AntiTBStartDate as timestamp,",
				"          NoDaysIPTDrugsDispensed as integer,",
				"          ClientCategory as string,",
				"          RefillVisitType as string,",
				"          SubVisitTypeCode as string,",
				"          TBScreeningIDSameDayScreening as string,",
				"          NowBreastfeeding as string,",
				"          TBRXIPTIDStatusDate as timestamp,",
				"          EACStatusCode as string,",
				"          EACStageID as integer,",
				"          CancerScreeningID as string,",
				"          HepatitisCScreening as string,",
				"          TBRXID as string,",
				"          TBRXIDStatusDate as timestamp,",
				"          FPMethodOtherSpecify as string,",
				"          CrAgTestResult as string,",
				"          BPDiastolic as float,",
				"          BPSystolic as float,",
				"          CSFCrAgTestResult as string,",
				"          EntryUserNumber as integer,",
				"          VisitRecordId as string,",
				"          VisitSubTypeId as integer,",
				"          GeneralVisitSubTypeId as integer,",
				"          KPCategoryCode as string,",
				"          NoDaysTBDrugsDispensed as integer,",
				"          TotalRequiredDosageNumberOfDaysTB as integer,",
				"          HFRCode as string,",
				"          ArchiveStatus as string,",
				"          PMTCTStatusCode as string,",
				"          PMTCTStatusDate as string,",
				"          CaCXManagementProcedureId as string,",
				"          CaCXManagementProcedureStatusDate as string,",
				"          ADRReported as string,",
				"          TBPreventiveTreatmentPeriodId as string,",
				"          TBCurativeTreatmentPeriodId as string,",
				"          PartialUpdateThroughIntegration as string,",
				"          CaCXScreeningDate as string,",
				"          TBScreeningID_First as string,",
				"          CancerScreeningID_2 as string,",
				"          CaCXScreeningDate_2 as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source1",
				"source(output(",
				"          Id as integer,",
				"          DivisionName as string,",
				"          PatientID as string,",
				"          DateOfBirth as timestamp,",
				"          Sex as string,",
				"          DateOfDeath as timestamp,",
				"          DateConfirmedHIVPositive as timestamp,",
				"          ReferredFromID as string,",
				"          FileRef as string,",
				"          MaritalStatus as string,",
				"          DrugAllergies as string,",
				"          CommunitySupportOrg as string,",
				"          PriorExposure as string,",
				"          TransferInId as string,",
				"          TBID as string,",
				"          HBCPatientCode as string,",
				"          TheHeight as double,",
				"          UserNumber as integer,",
				"          DateReadyStartART as timestamp,",
				"          StatusAtEnrollment as string,",
				"          HTCNumber as string,",
				"          HFRRegionCode as string,",
				"          HFRDistrictCode as string,",
				"          HFRDivisionCode as string,",
				"          HFRWardCode as string,",
				"          HFRVillMtaaCode as string,",
				"          DateJoinedGroup as timestamp,",
				"          HFRCouncilName as string,",
				"          VillageMtaaName as string,",
				"          HFRCouncilCode as string,",
				"          MissingFPReasonID as integer,",
				"          ReferredFromFacilityCode as string,",
				"          DateDiagnosedHIVPositive as timestamp,",
				"          ClientId as string,",
				"          SMSConsentTS as string,",
				"          ClientUniqueIdentifierType as string,",
				"          ClientUniqueIdentifierCode as string,",
				"          CTVisitId as string,",
				"          BiometricsEnrollmentDate as timestamp,",
				"          ReferredFromOtherSpecify as string,",
				"          PriorDrugAllergies as string,",
				"          PriorExposureOtherSpecify as string,",
				"          DateEnrolled as timestamp,",
				"          JoinedSupportOrganisation as string,",
				"          VerificationStatus as string,",
				"          VerificationStatusDate as timestamp,",
				"          HFRCode as string,",
				"          ArchiveStatus as string,",
				"          ClientBiometryRegStatus as string,",
				"          WHOStage_StartART as string,",
				"          CD4_StartART as string,",
				"          Weight_StartART as string,",
				"          SerumCrAgTest_StartART as string,",
				"          ClientCategory_StartART as string,",
				"          Pregnant_StartART as string,",
				"          Breastfeeding_StartART as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source2",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source3",
				"source1, source2 join(source1@PatientID == source2@PatientID,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1"
			]
		}
	}
}